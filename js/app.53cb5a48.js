(function(e){function t(t){for(var o,i,c=t[0],a=t[1],u=t[2],f=0,p=[];f<c.length;f++)i=c[f],Object.prototype.hasOwnProperty.call(r,i)&&r[i]&&p.push(r[i][0]),r[i]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);l&&l(t);while(p.length)p.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],o=!0,c=1;c<n.length;c++){var a=n[c];0!==r[a]&&(o=!1)}o&&(s.splice(t--,1),e=i(i.s=n[0]))}return e}var o={},r={app:0},s=[];function i(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=o,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)i.d(n,o,function(t){return e[t]}.bind(null,o));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var l=a;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"4da2":function(e,t,n){"use strict";var o=n("cae9"),r=n.n(o);r.a},"5e11":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="5e11"},b383:function(e,t,n){},cae9:function(e,t,n){},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("b383");var o,r=n("2b0e"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container"},[n("div",{staticClass:"container",class:{user:e.isClient,host:e.isHost}},[n("div",{directives:[{name:"show",rawName:"v-show",value:e.isHost,expression:"isHost"}],staticClass:"item"},[n("span",[e._v("Идентификатор сессии: "+e._s(e.sessionId))]),n("span",[e._v("Подключено пользователей: "+e._s(e.connectedUsersCount))])]),n("div",{staticClass:"item"},[n("div",{staticClass:"role"},[n("span",[e._v("Ваша роль")]),n("div",{staticClass:"image-role-container"},[e.userRole?n("img",{staticClass:"image-role",attrs:{src:e.userRole.link,title:e.userRole.name,alt:e.userRole.name}}):n("span",[e._v("[ Роль не выдана ]")])])]),n("div",{staticClass:"buttons"},[e.isClient?e._e():n("button",{attrs:{disabled:e.isHost},on:{click:e.serve}},[e._v("Создать сервер")]),e.isHost?n("button",{on:{click:e.takeRoles}},[e._v("Выдать роли")]):e._e(),e.isHost?e._e():n("button",{attrs:{disabled:e.connectionButtonDisabled},domProps:{textContent:e._s(e.connectionButtonStatus)},on:{click:e.connect}})])]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isHost,expression:"isHost"}],staticClass:"item"},[e._v(" Выберите файл ")])])])},i=[],c=(n("c740"),n("4160"),n("fb6a"),n("a434"),n("159b"),n("d4ec")),a=n("bee2"),u=n("262e"),l=n("2caf"),f=n("9ab4"),p=n("60a3");(function(e){e[e["NOT_CONNECTED"]=0]="NOT_CONNECTED",e[e["CONNECTION"]=1]="CONNECTION",e[e["CONNECTED"]=2]="CONNECTED",e[e["SERVE"]=3]="SERVE"})(o||(o={}));var d,v=n("a0bc"),h=n.n(v);(function(e){e[e["SET_ROLE"]=0]="SET_ROLE"})(d||(d={}));var b=function(e){Object(u["a"])(n,e);var t=Object(l["a"])(n);function n(){var e;return Object(c["a"])(this,n),e=t.apply(this,arguments),e.peer=null,e.connections=[],e.dataConnection=null,e.isHost=!1,e.isClient=!1,e.connection={status:o.NOT_CONNECTED},e.role=null,e.roles=[],e}return Object(a["a"])(n,[{key:"mounted",value:function(){var e=this;this.peer=new h.a,this.peer.on("connection",(function(t){t.on("open",(function(){e.connections.push(t)})),t.on("close",(function(){var n=e.connections.findIndex((function(e){return e.label===t.label}));n>-1&&e.connections.splice(n,1)})),t.on("error",(function(e){console.log(e)}))})),this.peer.on("error",(function(e){console.log(e)})),this.peer.on("close",(function(){}))}},{key:"serve",value:function(){this.isHost=!0}},{key:"connect",value:function(){var e=this;try{this.isClient=!0;var t=prompt("Введите идентификатор хоста","");if(null==t||""===t)throw new Error("Указанный идентификатор хоста недействителен");if(this.peer&&t){var n=this.peer.connect(t);n.on("data",(function(t){try{var n=JSON.parse(t);switch(n.event){case d.SET_ROLE:if(!n.data)throw new Error("Ошибка выдачи роли: от хоста поступило сообщение с пустой ролью");e.role=n.data;break;default:throw new Error("Неподдерживаемое событие")}}catch(o){alert(o.message)}})),n.on("error",(function(e){console.log(e)})),n.on("close",(function(){location.reload()}))}}catch(o){this.isClient=!1,alert(o.message)}}},{key:"takeRoles",value:function(){try{if(this.roles.length<this.connections.length+1)throw new Error("Количество ролей меньше, чем количество игроков");var e=this.roles.slice();e.sort((function(){return.5-Math.random()})),this.connections.forEach((function(t){t.send(JSON.stringify({event:d.SET_ROLE,data:e.pop()}))})),this.role=e.pop()}catch(t){alert(t.message)}}},{key:"fillRoles",value:function(){}},{key:"sessionId",get:function(){return this.peer?this.peer.id:""}},{key:"connectedUsersCount",get:function(){return this.connections.length}},{key:"userRole",get:function(){return this.role}},{key:"connectionButtonDisabled",get:function(){return this.connection.status!==o.NOT_CONNECTED}},{key:"connectionButtonStatus",get:function(){switch(this.connection.status){case o.CONNECTION:return"Подключение...";case o.CONNECTED:return"Подключено";default:return"Подключиться"}}}]),n}(p["b"]);b=Object(f["a"])([p["a"]],b);var O=b,C=O,E=(n("4da2"),n("2877")),y=Object(E["a"])(C,s,i,!1,null,"6958d2b2",null),N=y.exports;r["a"].config.productionTip=!1,new r["a"]({render:function(e){return e(N)}}).$mount("#app")}});
//# sourceMappingURL=app.53cb5a48.js.map